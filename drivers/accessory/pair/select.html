<!doctype html>
<html>
  <head>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' href='assets/mustard-ui.css'>
    <link rel='stylesheet' href='assets/style.css'>
    <script src='assets/vue.min.js'></script>
    <script src='assets/homey-pairing-mock.js'></script>
    <script src='assets/mock-setup.js'></script>
  </head>
  <body class='homekit-controller'>
    <div id='container-select'>
      <div v-if='accessory' class='panel'>
        <div class='panel-head'>
          <p class='panel-title'><i>{{ accessory.name }}</i></p>
        </div>
        <div class='panel-body row'>
        </div>
      </div>
      <div v-else>
        <div class='spinner'></div>
      </div>
    </div>
  </body>
  <script>
    new Vue({
      el:      '#container-select',
      data:    {
        accessory: null,
        accessories: [],
      },
      mounted() {
        Homey.emit('selectAccessory', (err, accessory) => {
          if (err) return this.handleError('Failed to get selected accessory: ' + err);
          console.log('Got selected accessory:', accessory);
          this.accessory = accessory;
          Homey.emit('getAccessories', (err, accessories) => {
            if (err) return this.handleError('Failed to get accessories: ' + err);
            this.accessories = accessories;
          });
        });
      },
      methods : {
        handleError(msg) {
          return Homey.alert(msg, 'error', () => {
            return Homey.showView('discover');
          });
        },
      }
    });
  </script>
</html>
